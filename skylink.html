<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Skylink Network | Bundles & Offers</title>
  <link rel="stylesheet" href="styles.css">
  <style>
  
  </style>
</head>
<body>
<header>
  <h1>Skylink Network</h1>
  <p>Affordable Data â€¢ Instant SMS â€¢ Bonus Minutes</p>
  <h2 class="header-contact">Call/SMS: 0795077967 / 0707177129</h2>
  <div class="top-buttons">
    <a href="#" class="btn" id="loginBtn">Login</a>
    <a href="#" class="btn" id="myAccountBtn" style="display:none;">My Account</a>
    <button class="btn cart-btn" id="viewCartBtn">
        View Cart <span class="cart-count" id="cartItemCount">0</span>
    </button>
    <a href="#" class="btn" id="logoutBtn" style="display:none;">Logout</a>
  </div>
</header>

<div class="controls-section">
    <div class="search-bar">
        <input type="text" id="bundleSearch" placeholder="Search bundles..." />
    </div>
    <div class="filter-buttons">
        <button class="filter-btn active" data-filter="all">All Bundles</button>
        <button class="filter-btn" data-filter="data">Data</button>
        <button class="filter-btn" data-filter="sms">SMS</button>
        <button class="filter-btn" data-filter="minutes">Call Minutes</button>
        <button class="filter-btn" data-filter="promotion">Promotions</button>
    </div>
</div>

  <div class="section" id="data-section">
    <h2>ðŸ“¡ Data Bundles</h2>
    <div class="card-container">
      <div class="card" data-category="data"><h3>50MB @ Ksh 10</h3><p>Light Browse & chat.</p><button class="add-to-cart-btn" data-name="50MB Data" data-price="10">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>100MB @ Ksh 20</h3><p>WhatsApp & news apps.</p><button class="add-to-cart-btn" data-name="100MB Data" data-price="20">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>250MB @ Ksh 40</h3><p>Daily Browse needs.</p><button class="add-to-cart-btn" data-name="250MB Data" data-price="40">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>500MB @ Ksh 70</h3><p>Half a gig of speed.</p><button class="add-to-cart-btn" data-name="500MB Data" data-price="70">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>1GB @ Ksh 100</h3><p>Stable for streaming.</p><button class="add-to-cart-btn" data-name="1GB Data" data-price="100">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>2GB @ Ksh 180</h3><p>Video calling, Browse.</p><button class="add-to-cart-btn" data-name="2GB Data" data-price="180">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>3GB @ Ksh 230</h3><p>Moderate usage deal.</p><button class="add-to-cart-btn" data-name="3GB Data" data-price="230">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>5GB @ Ksh 350</h3><p>Heavy social usage.</p><button class="add-to-cart-btn" data-name="5GB Data" data-price="350">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>10GB @ Ksh 500</h3><p>Weekend full usage.</p><button class="add-to-cart-btn" data-name="10GB Data" data-price="500">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>25GB @ Ksh 900</h3><p>Power user bundle.</p><button class="add-to-cart-btn" data-name="25GB Data" data-price="900">Add to Cart</button></div>
      <div class="card" data-category="data"><h3>50GB @ Ksh 1000</h3><p>Full monthly internet.</p><button class="add-to-cart-btn" data-name="50GB Data" data-price="1000">Add to Cart</button></div>
    </div>
  </div>

  <div class="section" id="sms-section">
    <h2>ðŸ’¬ SMS Bundles</h2>
    <div class="card-container">
      <div class="card" data-category="sms"><h3>10 SMS @ Ksh 5</h3><p>Quick messages.</p><button class="add-to-cart-btn" data-name="10 SMS" data-price="5">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>25 SMS @ Ksh 10</h3><p>Short updates.</p><button class="add-to-cart-btn" data-name="25 SMS" data-price="10">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>50 SMS @ Ksh 20</h3><p>Basic use.</p><button class="add-to-cart-btn" data-name="50 SMS" data-price="20">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>100 SMS @ Ksh 35</h3><p>Chat throughout day.</p><button class="add-to-cart-btn" data-name="100 SMS" data-price="35">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>150 SMS @ Ksh 50</h3><p>Light business use.</p><button class="add-to-cart-btn" data-name="150 SMS" data-price="50">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>200 SMS @ Ksh 75</h3><p>Bulk sender offer.</p><button class="add-to-cart-btn" data-name="200 SMS" data-price="75">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>300 SMS @ Ksh 100</h3><p>Marketing package.</p><button class="add-to-cart-btn" data-name="300 SMS" data-price="100">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>500 SMS @ Ksh 150</h3><p>Extended package.</p><button class="add-to-cart-btn" data-name="500 SMS" data-price="150">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>1000 SMS @ Ksh 300</h3><p>Heavy SMS needs.</p><button class="add-to-cart-btn" data-name="1000 SMS" data-price="300">Add to Cart</button></div>
      <div class="card" data-category="sms"><h3>2000 SMS @ Ksh 500</h3><p>Enterprise bundle.</p><button class="add-to-cart-btn" data-name="2000 SMS" data-price="500">Add to Cart</button></div>
    </div>
  </div>

  <div class="section" id="minutes-section">
    <h2>ðŸ“ž Call Minutes</h2>
    <div class="card-container">
      <div class="card" data-category="minutes"><h3>5 Mins @ Ksh 5</h3><p>Short calls.</p><button class="add-to-cart-btn" data-name="5 Mins" data-price="5">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>10 Mins @ Ksh 10</h3><p>Quick chats.</p><button class="add-to-cart-btn" data-name="10 Mins" data-price="10">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>20 Mins @ Ksh 20</h3><p>Fast updates.</p><button class="add-to-cart-btn" data-name="20 Mins" data-price="20">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>30 Mins @ Ksh 30</h3><p>Casual use.</p><button class="add-to-cart-btn" data-name="30 Mins" data-price="30">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>60 Mins @ Ksh 50</h3><p>Normal talk time.</p><button class="add-to-cart-btn" data-name="60 Mins" data-price="50">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>100 Mins @ Ksh 80</h3><p>For daily use.</p><button class="add-to-cart-btn" data-name="100 Mins" data-price="80">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>200 Mins @ Ksh 150</h3><p>Family & business.</p><button class="add-to-cart-btn" data-name="200 Mins" data-price="150">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>300 Mins @ Ksh 200</h3><p>Heavy users.</p><button class="add-to-cart-btn" data-name="300 Mins" data-price="200">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>600 Mins @ Ksh 350</h3><p>Multi-day calls.</p><button class="add-to-cart-btn" data-name="600 Mins" data-price="350">Add to Cart</button></div>
      <div class="card" data-category="minutes"><h3>1000 Mins @ Ksh 500</h3><p>Unmatched value.</p><button class="add-to-cart-btn" data-name="1000 Mins" data-price="500">Add to Cart</button></div>
    </div>
  </div>

  <div class="section" id="promotion-section">
    <h2>ðŸŽ‰ General Promotions <span class="promotion-timer" id="promoCountdown"></span></h2>
    <div class="card-container">
      <div class="card" data-category="promotion">
        <h3>15% Sitewide Discount</h3>
        <p>All bundles are 15% off for the next <span id="dynamicPromoTime">2 hours</span>!</p>
        <div class="code">Use Code: 15%NOW</div>
        <p class="note">Apply during checkout.</p>
        <button class="add-to-cart-btn" data-name="15% Sitewide Discount" data-price="0" data-is-promo="true">Add to Cart</button>
      </div>
      <div class="card" data-category="promotion">
        <h3>Refer & Save</h3>
        <p>Refer a friend and get <strong>10% off</strong> your next purchase.</p>
        <p class="note">Enter referral code below.</p>
        <input class="referral-input" type="text" id="referralCode" placeholder="Enter referral code">
        <button class="add-to-cart-btn" id="inviteFriendBtn" data-name="Referral Program" data-price="0">Invite Friend</button>
      </div>
      <div class="card" data-category="promotion">
        <h3>Loyalty Bonus</h3>
        <p>Get <strong>5% bonus</strong> after every 3rd purchase.</p>
        <button class="add-to-cart-btn" data-name="Loyalty Bonus" data-price="0">Join Now</button>
      </div>
    </div>
  </div>

<div id="paymentModal" class="modal">
  <div class="modal-content">
    <h3>Your Cart</h3>

    <div class="cart-items-display" id="cartItemsDisplay">
      <p id="emptyCartMessage">Your cart is empty.</p>
    </div>
    <div class="cart-summary" id="cartSummary">
        Total: Ksh <span id="cartTotalPrice">0</span>
    </div>

    <input type="text" id="userPhone" placeholder="Enter Phone Number" />
    <span class="error-message" id="phoneError"></span>
    <input type="email" id="userEmail" placeholder="Enter Email Address" />
    <span class="error-message" id="emailError"></span>

    <h4>Select Payment Method</h4>
    <div class="payment-options-container">
      <div class="payment-option" data-payment-method="M-Pesa">M-Pesa</div>
      <div class="payment-option" data-payment-method="Airtel Money">Airtel Money</div>
      <div class="payment-option" data-payment-method="PayPal">PayPal</div>
      <div class="payment-option" data-payment-method="ATM Card">ATM Card</div>
      <div class="payment-option" data-payment-method="Bank Transfer">Bank Transfer</div>
      <div class="payment-option" data-payment-method="Crypto">Crypto</div>
    </div>
    <span class="error-message" id="paymentMethodError"></span>

    <button class="checkout-btn" onclick="submitCheckout()">Proceed to Checkout</button>
    <button class="close-btn" onclick="closeModal()">Cancel</button>
  </div>
</div>

<button class="live-chat-btn" title="Chat with us!">ðŸ’¬</button>

<footer>
  &copy; 2025 Skylink Network. All rights reserved. | Powered by j&M limited
<div class="social-links">
  <a href="https://facebook.com" target="_blank"><i class="fab fa-facebook-f"></i></a>
  <a href="https://twitter.com" target="_blank"><i class="fab fa-twitter"></i></a>
  <a href="https://instagram.com" target="_blank"><i class="fab fa-instagram"></i></a>
  <a href="https://wa.me/0795077967" target="_blank" style="color: #25D366;"><i class="fab fa-whatsapp"></i></a>
</div> <br>
</footer>

<script>
  // --- DOM Elements ---
  const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
  const modal = document.getElementById('paymentModal');
  const cartItemCount = document.getElementById('cartItemCount');
  const viewCartBtn = document.getElementById('viewCartBtn');
  const cartItemsDisplay = document.getElementById('cartItemsDisplay');
  const cartTotalPriceSpan = document.getElementById('cartTotalPrice');
  const emptyCartMessage = document.getElementById('emptyCartMessage');
  const paymentOptions = document.querySelectorAll('.payment-option');
  const userPhoneInput = document.getElementById('userPhone');
  const userEmailInput = document.getElementById('userEmail');
  const phoneError = document.getElementById('phoneError');
  const emailError = document.getElementById('emailError');
  const paymentMethodError = document.getElementById('paymentMethodError');
  const bundleSearchInput = document.getElementById('bundleSearch');
  const filterButtons = document.querySelectorAll('.filter-btn');
  const allCards = document.querySelectorAll('.card');
  const promoCountdownSpan = document.getElementById('promoCountdown');
  const dynamicPromoTimeSpan = document.getElementById('dynamicPromoTime');
  const referralCodeInput = document.getElementById('referralCode');
  const inviteFriendBtn = document.getElementById('inviteFriendBtn');

  // --- Global Variables ---
  let cart = JSON.parse(localStorage.getItem('skylinkCart')) || []; // Load cart from localStorage
  let selectedPaymentMethod = '';
  let loggedIn = false; // Simple state for login

  // --- Functions ---

  function updateCartCount() {
    cartItemCount.textContent = cart.length;
    cartItemCount.style.display = cart.length > 0 ? 'inline' : 'none';
  }

  function saveCart() {
    localStorage.setItem('skylinkCart', JSON.stringify(cart));
  }

  function displayCartItems() {
    cartItemsDisplay.innerHTML = ''; // Clear previous items
    if (cart.length === 0) {
      emptyCartMessage.style.display = 'block';
      cartSummary.style.display = 'none';
      return;
    }

    emptyCartMessage.style.display = 'none';
    cartSummary.style.display = 'block';

    let total = 0;
    cart.forEach((item, index) => {
      const cartItemDiv = document.createElement('div');
      cartItemDiv.classList.add('cart-item');
      cartItemDiv.innerHTML = `
        <span class="cart-item-name">${item.name}</span>
        <span class="cart-item-price">Ksh ${item.price}</span>
        <button class="cart-item-remove" data-index="${index}">Ã—</button>
      `;
      cartItemsDisplay.appendChild(cartItemDiv);
      total += item.price;
    });

    cartTotalPriceSpan.textContent = total;
  }

  function openModal() {
    displayCartItems(); // Update cart display every time modal opens
    modal.style.display = 'block';
  }

  function closeModal() {
    modal.style.display = 'none';
    // Clear validation errors on close
    userPhoneInput.classList.remove('input-error');
    userEmailInput.classList.remove('input-error');
    phoneError.textContent = '';
    emailError.textContent = '';
    paymentMethodError.textContent = '';
  }

  function submitCheckout() {
    let isValid = true;

    // Clear previous errors
    userPhoneInput.classList.remove('input-error');
    userEmailInput.classList.remove('input-error');
    phoneError.textContent = '';
    emailError.textContent = '';
    paymentMethodError.textContent = '';

    const phone = userPhoneInput.value.trim();
    const email = userEmailInput.value.trim();

    // Phone validation (simple Kenyan number format)
    const phoneRegex = /^(0|254)\d{9}$/; // Starts with 0 or 254, followed by 9 digits
    if (phone === "") {
      phoneError.textContent = "Phone number is required.";
      userPhoneInput.classList.add('input-error');
      isValid = false;
    } else if (!phoneRegex.test(phone)) {
      phoneError.textContent = "Please enter a valid Kenyan phone number (e.g., 07XXXXXXXX or 2547XXXXXXXX).";
      userPhoneInput.classList.add('input-error');
      isValid = false;
    }

    // Email validation
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (email === "") {
      emailError.textContent = "Email address is required.";
      userEmailInput.classList.add('input-error');
      isValid = false;
    } else if (!emailRegex.test(email)) {
      emailError.textContent = "Please enter a valid email address.";
      userEmailInput.classList.add('input-error');
      isValid = false;
    }

    if (selectedPaymentMethod === "") {
      paymentMethodError.textContent = "Please select a payment method.";
      isValid = false;
    }

    if (cart.length === 0) {
        alert("Your cart is empty. Please add items before checking out.");
        isValid = false;
    }

    if (!isValid) {
      return;
    }

    // Construct purchase details
    const purchaseDetails = {
      items: cart,
      phone: phone,
      email: email,
      paymentMethod: selectedPaymentMethod,
      totalPrice: parseInt(cartTotalPriceSpan.textContent) // Ensure price is an integer
    };

    // In a real application, you would send this 'purchaseDetails' object
    // to a backend API for processing payment and bundle activation.
    console.log("Purchase Details:", purchaseDetails);
    alert(
      `Checkout initiated!
      Items: ${cart.map(item => item.name).join(', ')}
      Total: Ksh ${purchaseDetails.totalPrice}
      Phone: ${phone}
      Email: ${email}
      Payment Method: ${selectedPaymentMethod}

      (This is a demo alert. In a real app, this would proceed to actual payment gateway.)`
    );

    // Clear cart after successful "checkout"
    cart = [];
    saveCart();
    updateCartCount();
    closeModal();
  }

  function updateFilteredCards(searchTerm, filterCategory) {
    const lowerCaseSearchTerm = searchTerm.toLowerCase();

    allCards.forEach(card => {
      const cardTitle = card.querySelector('h3').textContent.toLowerCase();
      const cardCategory = card.dataset.category;

      const matchesSearch = searchTerm === '' || cardTitle.includes(lowerCaseSearchTerm);
      const matchesFilter = filterCategory === 'all' || cardCategory === filterCategory;

      if (matchesSearch && matchesFilter) {
        card.classList.remove('hidden');
      } else {
        card.classList.add('hidden');
      }
    });
  }

  function startPromotionCountdown() {
    // Set the end date for the promotion (e.g., 2 hours from now)
    const promotionEndTime = new Date();
    promotionEndTime.setHours(promotionEndTime.getHours() + 2); // 2 hours from current time

    // For demonstration, let's make it fixed 2 hours from page load.
    // In a real scenario, this would come from a server or fixed time.
    const promoInterval = setInterval(() => {
        const now = new Date().getTime();
        const distance = promotionEndTime - now;

        if (distance < 0) {
            clearInterval(promoInterval);
            promoCountdownSpan.textContent = 'Expired!';
            dynamicPromoTimeSpan.textContent = 'expired';
            // Optionally disable the promotion card's add to cart button
            return;
        }

        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        promoCountdownSpan.textContent = `Ends in: ${hours}h ${minutes}m ${seconds}s`;
        dynamicPromoTimeSpan.textContent = `${hours} hours ${minutes} minutes`;

    }, 1000);
  }

  // --- Event Listeners ---

  // Add to Cart buttons
  addToCartButtons.forEach(button => {
    button.addEventListener('click', (event) => {
      const name = event.target.dataset.name;
      const price = parseFloat(event.target.dataset.price); // Use parseFloat for prices
      const isPromo = event.target.dataset.isPromo === 'true'; // Check if it's a promo

      // Prevent adding multiple identical promotions, or handle them differently
      if (isPromo && cart.some(item => item.name === name)) {
          alert(`"${name}" is already in your cart or is a special promotion item that can only be added once.`);
          return;
      }
      if (name === "Referral Program" || name === "Loyalty Bonus") {
          // These are action buttons, not items to add to cart for purchase
          return;
      }

      cart.push({ name, price });
      saveCart();
      updateCartCount();
      alert(`"${name}" added to cart!`);
    });
  });

  // Remove item from cart within modal
  cartItemsDisplay.addEventListener('click', (event) => {
    if (event.target.classList.contains('cart-item-remove')) {
      const indexToRemove = parseInt(event.target.dataset.index);
      cart.splice(indexToRemove, 1); // Remove item from array
      saveCart();
      updateCartCount();
      displayCartItems(); // Re-render cart
    }
  });


  // Open modal when View Cart button is clicked
  viewCartBtn.addEventListener('click', openModal);

  // Close modal when background is clicked
  window.onclick = function(event) {
    if (event.target === modal) {
      closeModal();
    }
  }

  // Payment Option selection
  paymentOptions.forEach(option => {
    option.addEventListener('click', (event) => {
      paymentOptions.forEach(opt => opt.classList.remove('selected')); // Deselect all
      event.currentTarget.classList.add('selected'); // Select clicked one
      selectedPaymentMethod = event.currentTarget.dataset.paymentMethod;
      paymentMethodError.textContent = ''; // Clear error on selection
    });
  });

  // Referral Code submission
  inviteFriendBtn.addEventListener('click', () => {
    const code = referralCodeInput.value.trim();
    if (code) {
      alert(`Referral code "${code}" submitted! Thank you for referring a friend.`);
      referralCodeInput.value = ''; // Clear input after submission
    } else {
      alert("Please enter a referral code.");
    }
  });

  // Search functionality
  bundleSearchInput.addEventListener('keyup', () => {
    const searchTerm = bundleSearchInput.value;
    const activeFilterButton = document.querySelector('.filter-btn.active');
    const currentFilter = activeFilterButton ? activeFilterButton.dataset.filter : 'all';
    updateFilteredCards(searchTerm, currentFilter);
  });

  // Filter functionality
  filterButtons.forEach(button => {
    button.addEventListener('click', (event) => {
      filterButtons.forEach(btn => btn.classList.remove('active')); // Deactivate all
      event.currentTarget.classList.add('active'); // Activate clicked one

      const filterCategory = event.currentTarget.dataset.filter;
      const searchTerm = bundleSearchInput.value;
      updateFilteredCards(searchTerm, filterCategory);

      // Hide/show sections based on filter for better visual grouping
      document.getElementById('data-section').style.display = (filterCategory === 'all' || filterCategory === 'data') ? 'block' : 'none';
      document.getElementById('sms-section').style.display = (filterCategory === 'all' || filterCategory === 'sms') ? 'block' : 'none';
      document.getElementById('minutes-section').style.display = (filterCategory === 'all' || filterCategory === 'minutes') ? 'block' : 'none';
      document.getElementById('promotion-section').style.display = (filterCategory === 'all' || filterCategory === 'promotion') ? 'block' : 'none';
    });
  });

  // Login/Logout (basic UI toggle)
  document.getElementById('loginBtn').addEventListener('click', (e) => {
      e.preventDefault();
      loggedIn = true;
      document.getElementById('loginBtn').style.display = 'none';
      document.getElementById('logoutBtn').style.display = 'inline-block';
      document.getElementById('myAccountBtn').style.display = 'inline-block';
      alert('Logged in successfully! (UI change only)');
  });

  document.getElementById('logoutBtn').addEventListener('click', (e) => {
      e.preventDefault();
      loggedIn = false;
      document.getElementById('loginBtn').style.display = 'inline-block';
      document.getElementById('logoutBtn').style.display = 'none';
      document.getElementById('myAccountBtn').style.display = 'none';
      alert('Logged out. (UI change only)');
  });


  // --- Initial Setup ---
  updateCartCount(); // Update cart count on page load
  startPromotionCountdown(); // Start the countdown timer
</script>

</body>
</html>